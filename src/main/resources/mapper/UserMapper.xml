<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.jwt.mapper.UserMapper">

    <!-- 更新用户登录失败次数 -->
    <update id="updateLoginFailCount">
        UPDATE user 
        SET login_fail_count = #{failCount}, updated_time = NOW()
        WHERE id = #{userId} AND deleted = 0
    </update>

    <!-- 重置用户登录失败次数 -->
    <update id="resetLoginFailCount">
        UPDATE user 
        SET login_fail_count = 0, updated_time = NOW()
        WHERE id = #{userId} AND deleted = 0
    </update>

    <!-- 锁定用户账户 -->
    <update id="lockUser">
        UPDATE user 
        SET lock_time = NOW(), updated_time = NOW()
        WHERE id = #{userId} AND deleted = 0
    </update>

    <!-- 解锁用户账户 -->
    <update id="unlockUser">
        UPDATE user 
        SET lock_time = NULL, login_fail_count = 0, updated_time = NOW()
        WHERE id = #{userId} AND deleted = 0
    </update>

</mapper>